import{j as e,C as _,b as $,U as J,B as u,D as K,k as Q,l as W,m as X,n as Y,o as Z}from"./index-CcEawOUw.js";import{r as a}from"./vendor-recharts-CyIoRYya.js";import{g as x}from"./api-Cm2U3YZA.js";import{I as f}from"./input-HjoYoDwl.js";import{L as v}from"./label-ygqNvpnd.js";import{b as ee,c as se,T as C,d as i,e as te,a as d}from"./table-CHURUtnh.js";import{S as y,a as D,b as I,c as T,d as l}from"./select-DU-e5NNg.js";import{t as c}from"./vendor-ui-Cvn9ctBs.js";import{S as oe}from"./search-E7gj5zgS.js";import{S as ae}from"./square-pen-C2Of3dyA.js";import{T as re}from"./trash-2-bv6PzYlD.js";import"./vendor-react-YualkU3Z.js";import"./vendor-firebase-BLqY7lrF.js";import"./useComposition-iS-LvcVy.js";import"./index-CPgN7Qgo.js";import"./index-ChHGvnL7.js";import"./check-4fMukZno.js";function Se(){const[E,g]=a.useState(!1),[L,p]=a.useState(null),[m,z]=a.useState(""),[h,M]=a.useState("all"),[F,B]=a.useState([]),[A,O]=a.useState([]),[P,N]=a.useState(!0),[S,w]=a.useState(!1),[o,n]=a.useState({nome:"",email:"",mentorId:""}),j=async()=>{try{N(!0);const[s,t]=await Promise.all([x.getAllAlunos(),x.getMentores()]);B(s),O(t)}catch(s){throw c.error(s.message||"Erro ao carregar dados"),s}finally{N(!1)}};a.useEffect(()=>{j()},[]);const b=()=>{n({nome:"",email:"",mentorId:""})},k=s=>{p(s),n({nome:s.nome,email:s.email,mentorId:s.mentorId}),g(!0)},q=async s=>{if(s.preventDefault(),!o.nome||!o.email||!o.mentorId){c.error("Preencha todos os campos obrigatÃ³rios");return}try{w(!0),await x.updateAluno({alunoId:L.id,...o}),c.success("Aluno atualizado com sucesso!"),g(!1),p(null),b(),await j()}catch(t){c.error(t.message||"Erro ao atualizar aluno")}finally{w(!1)}},V=async(s,t)=>{if(window.confirm(`Tem certeza que deseja remover o aluno "${t}"?`))try{await x.deleteAluno(s),c.success("Aluno removido com sucesso!"),await j()}catch(r){c.error(r.message||"Erro ao remover aluno")}},H=s=>s==="avulso"?"ðŸ“Œ Avulso":s==="todos"?"ðŸŒ Compartilhado":A?.find(r=>r.id===s)?.nome||"Sem mentor",G=F?.filter(s=>{const t=s.nome||"",r=s.email||"",R=t.toLowerCase().includes(m.toLowerCase())||r.toLowerCase().includes(m.toLowerCase()),U=h==="all"||s.mentorId===h;return R&&U});return P?e.jsx("div",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:130",className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:131",className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):e.jsxs("div",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:137",className:"space-y-6",children:[e.jsx("div",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:138",className:"flex items-center justify-between",children:e.jsxs("div",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:139",children:[e.jsx("h1",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:140",className:"text-3xl font-bold",children:"Gerenciamento de Alunos"}),e.jsx("p",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:141",className:"text-muted-foreground mt-1",children:"Visualize e gerencie todos os alunos da plataforma"})]})}),e.jsx(_,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:147",children:e.jsxs($,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:148",className:"pt-6",children:[e.jsxs("div",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:149",className:"flex items-center gap-4 mb-4 flex-wrap",children:[e.jsxs("div",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:150",className:"flex items-center gap-2 flex-1 min-w-[200px]",children:[e.jsx(oe,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:151",className:"h-4 w-4 text-muted-foreground"}),e.jsx(f,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:152",placeholder:"Buscar por nome ou email...",value:m,onChange:s=>z(s.target.value),className:"max-w-sm"})]}),e.jsxs(y,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:159",value:h,onValueChange:M,children:[e.jsx(D,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:160",className:"w-[250px]",children:e.jsx(I,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:161",placeholder:"Filtrar por mentor"})}),e.jsxs(T,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:163",children:[e.jsx(l,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:164",value:"all",children:"Todos os mentores"}),e.jsx(l,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:165",value:"avulso",children:"ðŸ“Œ Avulso (sem mentor)"}),e.jsx(l,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:166",value:"todos",children:"ðŸŒ Compartilhado (todos os mentores)"}),A?.map(s=>e.jsxs(l,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:168",value:s.id,children:[s.nome," - ",s.nomePlataforma]},s.id))]})]})]}),!G||G.length===0?e.jsxs("div",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:177",className:"text-center py-12 text-muted-foreground",children:[e.jsx(J,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:178",className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:179",children:m?"Nenhum aluno encontrado com esse termo":"Nenhum aluno cadastrado ainda"})]}):e.jsx("div",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:186",className:"rounded-md border",children:e.jsxs(ee,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:187",children:[e.jsx(se,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:188",children:e.jsxs(C,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:189",children:[e.jsx(i,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:190",children:"Nome"}),e.jsx(i,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:191",children:"Email"}),e.jsx(i,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:192",children:"Mentor"}),e.jsx(i,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:193",children:"Data de Cadastro"}),e.jsx(i,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:194",className:"text-right",children:"AÃ§Ãµes"})]})}),e.jsx(te,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:197",children:G.map(s=>e.jsxs(C,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:199",children:[e.jsx(d,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:200",className:"font-medium",children:s.nome||"Sem nome"}),e.jsx(d,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:201",children:s.email||"Sem email"}),e.jsx(d,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:202",children:H(s.mentorId)}),e.jsx(d,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:203",children:(()=>{let t;if(s.createdAt?.toDate)t=s.createdAt.toDate();else if(s.createdAt?.seconds||s.createdAt?._seconds){const r=s.createdAt.seconds||s.createdAt._seconds;t=new Date(r*1e3)}else t=new Date(s.createdAt);return t.toLocaleDateString("pt-BR")})()}),e.jsx(d,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:217",className:"text-right",children:e.jsxs("div",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:218",className:"flex justify-end gap-2",children:[e.jsx(u,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:219",variant:"ghost",size:"icon",onClick:()=>k(s),children:e.jsx(ae,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:224",className:"h-4 w-4"})}),e.jsx(u,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:226",variant:"ghost",size:"icon",onClick:()=>V(s.id,s.nome),children:e.jsx(re,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:231",className:"h-4 w-4 text-destructive"})})]})})]},s.id))})]})})]})}),e.jsx(K,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:244",open:E,onOpenChange:g,children:e.jsx(Q,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:245",className:"sm:max-w-[500px]",children:e.jsxs("form",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:246",onSubmit:q,children:[e.jsxs(W,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:247",children:[e.jsx(X,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:248",children:"Editar Aluno"}),e.jsx(Y,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:249",children:"Atualize as informaÃ§Ãµes do aluno ou altere o mentor vinculado"})]}),e.jsxs("div",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:254",className:"space-y-4 py-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:255",className:"space-y-2",children:[e.jsx(v,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:256",htmlFor:"nome",children:"Nome *"}),e.jsx(f,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:257",id:"nome",value:o.nome,onChange:s=>n({...o,nome:s.target.value}),placeholder:"Nome do aluno",required:!0})]}),e.jsxs("div",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:266",className:"space-y-2",children:[e.jsx(v,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:267",htmlFor:"email",children:"Email *"}),e.jsx(f,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:268",id:"email",type:"email",value:o.email,onChange:s=>n({...o,email:s.target.value}),placeholder:"email@exemplo.com",required:!0,disabled:!0}),e.jsx("p",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:277",className:"text-xs text-muted-foreground",children:"O email nÃ£o pode ser alterado"})]}),e.jsxs("div",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:282",className:"space-y-2",children:[e.jsx(v,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:283",htmlFor:"mentorId",children:"Mentor *"}),e.jsxs(y,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:284",value:o.mentorId,onValueChange:s=>n({...o,mentorId:s}),children:[e.jsx(D,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:290",children:e.jsx(I,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:291",placeholder:"Selecione um mentor"})}),e.jsxs(T,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:293",children:[e.jsx(l,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:294",value:"avulso",children:"ðŸ“Œ Avulso (sem mentor)"}),e.jsx(l,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:295",value:"todos",children:"ðŸŒ Compartilhado (todos os mentores)"}),A?.map(s=>e.jsxs(l,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:297",value:s.id,children:[s.nome," - ",s.nomePlataforma]},s.id))]})]}),e.jsx("p",{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:303",className:"text-xs text-muted-foreground",children:"Altere o mentor vinculado a este aluno"})]})]}),e.jsxs(Z,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:309",children:[e.jsx(u,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:310",type:"button",variant:"outline",onClick:()=>{g(!1),p(null),b()},children:"Cancelar"}),e.jsx(u,{"data-loc":"client/src/pages/gestor/GestorAlunos.tsx:321",type:"submit",disabled:S,children:S?"Salvando...":"Atualizar"})]})]})})})]})}export{Se as default};
