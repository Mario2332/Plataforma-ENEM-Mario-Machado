import{j as a,C as O,f as z,g as I,b as Y,h as oa,D as ra,k as ta,l as na,m as la}from"./index-DJaLpd4Q.js";import{r as l}from"./vendor-recharts-DGENtP1g.js";import{I as sa}from"./input-DSmHUlch.js";import{P as ca}from"./palette-DV1GqQua.js";import{C as ia}from"./copy-DYsjcJXB.js";import{t as v}from"./vendor-ui-Dwsdq65V.js";import{i as q,j as da}from"./firestore-direct-BK5bE8GO.js";import{C as ua,a as ma}from"./skeleton-loader-W3Mn_X_o.js";import{a as ga}from"./MentorViewContext-D8MT48_N.js";import{L as pa}from"./loader-circle-K7hmtMv5.js";import{S as xa}from"./sparkles-DJkLXIth.js";import{C as Ca}from"./clock-wIoX7eN3.js";import"./vendor-react-BLxlFB_W.js";import"./vendor-firebase-DcZa5tA2.js";import"./useComposition-JJU1F6nw.js";const ha=l.memo(function({slot:c,isEditing:h,onStartEdit:p,onStopEdit:k,onActivityChange:M,onColorPickerOpen:N,onCopy:d,onPaste:S,onDragStart:H,onDrop:w,hasCopiedCell:$}){const B=s=>{s.preventDefault()},y=s=>{s.preventDefault(),$?S():d()},x=s=>{(s.key==="Enter"||s.key==="Escape")&&k()};return a.jsx("td",{"data-loc":"client/src/components/CronogramaCell.tsx:70",className:"border-2 border-border p-0 h-12 relative group transition-all hover:shadow-lg",style:{backgroundColor:c.color},draggable:!h&&c.activity!=="",onDragStart:H,onDragOver:B,onDrop:w,onContextMenu:y,children:h?a.jsx(sa,{"data-loc":"client/src/components/CronogramaCell.tsx:80",autoFocus:!0,value:c.activity,onChange:s=>M(s.target.value),onBlur:k,onKeyDown:x,className:"h-full border-0 text-xs p-2 font-semibold",style:{backgroundColor:c.color}}):a.jsxs("div",{"data-loc":"client/src/components/CronogramaCell.tsx:90",onClick:p,className:"h-full w-full p-2 text-xs cursor-pointer flex items-center justify-between font-semibold",children:[a.jsx("span",{"data-loc":"client/src/components/CronogramaCell.tsx:94",className:"truncate flex-1",children:c.activity}),a.jsxs("div",{"data-loc":"client/src/components/CronogramaCell.tsx:95",className:"opacity-0 group-hover:opacity-100 flex gap-1 transition-opacity",children:[a.jsx("button",{"data-loc":"client/src/components/CronogramaCell.tsx:96",onClick:s=>{s.stopPropagation(),N()},className:"p-1 hover:bg-black/20 dark:hover:bg-white/20 rounded transition-colors",children:a.jsx(ca,{"data-loc":"client/src/components/CronogramaCell.tsx:103",className:"h-3.5 w-3.5"})}),a.jsx("button",{"data-loc":"client/src/components/CronogramaCell.tsx:105",onClick:s=>{s.stopPropagation(),d()},className:"p-1 hover:bg-black/20 dark:hover:bg-white/20 rounded transition-colors",title:"Copiar",children:a.jsx(ia,{"data-loc":"client/src/components/CronogramaCell.tsx:113",className:"h-3.5 w-3.5"})})]})]})})}),K=["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],fa=Array.from({length:24},(g,c)=>c),ba=[0,30],va=[{name:"Laranja",value:"#FFA500"},{name:"Azul",value:"#4A90E2"},{name:"Verde",value:"#50C878"},{name:"Rosa",value:"#FF69B4"},{name:"Roxo",value:"#9B59B6"},{name:"Amarelo",value:"#FFD700"},{name:"Vermelho",value:"#E74C3C"},{name:"Cinza",value:"#95A5A6"},{name:"Branco",value:"#FFFFFF"},{name:"Turquesa",value:"#1ABC9C"},{name:"Azul Marinho",value:"#2C3E50"},{name:"Lilás",value:"#BB8FCE"},{name:"Coral",value:"#FF7F50"},{name:"Verde Limão",value:"#32CD32"},{name:"Azul Claro",value:"#87CEEB"},{name:"Salmão",value:"#FA8072"}];function Ba(){const g=ga(),[c,h]=l.useState([]),[p,k]=l.useState(null),[M,N]=l.useState(null),[d,S]=l.useState(null),[H,w]=l.useState(!0),[$,B]=l.useState(!1),[y,x]=l.useState("idle"),[s,T]=l.useState(null),A=l.useRef(null),F=l.useRef(!1),R=l.useRef([]),j=l.useRef(null);l.useEffect(()=>{R.current=c},[c]),l.useEffect(()=>{j.current=g},[g]),l.useEffect(()=>g?((async()=>{w(!0),F.current=!1;try{await U()}finally{w(!1)}})(),()=>{A.current&&clearTimeout(A.current),F.current&&j.current&&V(R.current,j.current)}):void 0,[g]);const U=async()=>{try{const e=await da(g),o=[];e.forEach(t=>{const[r,n]=t.horaInicio.split(":").map(Number),[b,u]=t.horaFim.split(":").map(Number);let i=r,C=n;for(;i<b||i===b&&C<u;)o.push({day:t.diaSemana,hour:i,minute:C,activity:t.materia+(t.descricao?` - ${t.descricao}`:""),color:t.cor||"#FFFFFF"}),C+=30,C>=60&&(C=0,i++)}),h(o),x("idle")}catch(e){v.error(e.message||"Erro ao carregar cronograma")}},E=(e,o,t)=>`${e}-${o}-${t}`,D=l.useMemo(()=>{const e=new Map;return c.forEach(o=>e.set(E(o.day,o.hour,o.minute),o)),e},[c]),f=l.useCallback((e,o,t)=>{const r=E(e,o,t);return D.get(r)||{day:e,hour:o,minute:t,activity:"",color:"#FFFFFF"}},[D]),P=e=>{const o=[...e].filter(r=>r.activity).sort((r,n)=>r.day!==n.day?r.day-n.day:r.hour!==n.hour?r.hour-n.hour:r.minute-n.minute),t=[];return o.forEach(r=>{const n=t[t.length-1];n&&n.day===r.day&&n.activity===r.activity&&n.color===r.color&&(n.endHour===r.hour&&n.endMinute===r.minute||n.endHour===r.hour-1&&n.endMinute===30&&r.minute===0)?(n.endHour=r.hour,n.endMinute=r.minute+30,n.endMinute>=60&&(n.endMinute=0,n.endHour++)):(t.push({day:r.day,startHour:r.hour,startMinute:r.minute,endHour:r.hour,endMinute:r.minute+30,activity:r.activity,color:r.color}),t[t.length-1].endMinute>=60&&(t[t.length-1].endMinute=0,t[t.length-1].endHour++))}),t.map(r=>({diaSemana:r.day,horaInicio:`${String(r.startHour).padStart(2,"0")}:${String(r.startMinute).padStart(2,"0")}`,horaFim:`${String(r.endHour).padStart(2,"0")}:${String(r.endMinute).padStart(2,"0")}`,materia:r.activity.split(" - ")[0].trim(),descricao:r.activity.split(" - ").slice(1).join(" - ").trim()||"",cor:r.color}))},V=async(e,o)=>{try{const t=P(e);await q(t,o)}catch{}},L=l.useCallback(()=>{F.current=!0,x("saving"),A.current&&clearTimeout(A.current),A.current=setTimeout(async()=>{if(j.current)try{const e=P(R.current);await q(e,j.current),F.current=!1,x("saved"),setTimeout(()=>{x("idle")},2e3)}catch{x("error"),v.error("Erro ao salvar cronograma. Tente novamente.")}},1500)},[]),m=l.useCallback((e,o,t,r)=>{const n=E(e,o,t),b=D.has(n);h(b?u=>u.map(i=>i.day===e&&i.hour===o&&i.minute===t?{...i,...r}:i):u=>[...u,{day:e,hour:o,minute:t,activity:"",color:"#FFFFFF",...r}]),L()},[D,L]),G=l.useCallback((e,o,t)=>{const r=f(e,o,t);k(r),v.success("Célula copiada!")},[f]),Q=l.useCallback((e,o,t)=>{if(!p){v.error("Nenhuma célula copiada");return}m(e,o,t,{activity:p.activity,color:p.color}),v.success("Célula colada!")},[p,m]),_=l.useCallback((e,o,t)=>{S({day:e,hour:o,minute:t})},[]),J=l.useCallback((e,o,t)=>{if(!d)return;const r=f(d.day,d.hour,d.minute),n=f(e,o,t);m(e,o,t,{activity:r.activity,color:r.color}),m(d.day,d.hour,d.minute,{activity:n.activity,color:n.color}),S(null),v.success("Atividade movida!")},[d,f,m]),W=l.useCallback(e=>{N(e)},[]),X=l.useCallback(()=>{N(null)},[]),Z=l.useCallback((e,o,t,r)=>{m(e,o,t,{activity:r})},[m]),aa=l.useCallback((e,o,t)=>{T({day:e,hour:o,minute:t})},[]),ea=(e,o)=>`${String(e).padStart(2,"0")}:${String(o).padStart(2,"0")}`;return H?a.jsx("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:351",className:"space-y-8 pb-8",children:a.jsx(ua,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:352"})}):a.jsxs("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:358",className:"space-y-6",children:[a.jsxs("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:360",className:"flex justify-end items-center gap-2",children:[y==="saving"&&a.jsxs("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:362",className:"flex items-center gap-2 text-sm text-muted-foreground bg-yellow-50 dark:bg-yellow-900/20 px-3 py-1.5 rounded-full border border-yellow-200 dark:border-yellow-800",children:[a.jsx(pa,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:363",className:"h-4 w-4 animate-spin text-yellow-600"}),a.jsx("span",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:364",children:"Salvando..."})]}),y==="saved"&&a.jsxs("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:368",className:"flex items-center gap-2 text-sm text-green-600 bg-green-50 dark:bg-green-900/20 px-3 py-1.5 rounded-full border border-green-200 dark:border-green-800",children:[a.jsx(ma,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:369",className:"h-4 w-4"}),a.jsx("span",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:370",children:"Salvo automaticamente"})]}),y==="error"&&a.jsx("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:374",className:"flex items-center gap-2 text-sm text-red-600 bg-red-50 dark:bg-red-900/20 px-3 py-1.5 rounded-full border border-red-200 dark:border-red-800",children:a.jsx("span",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:375",children:"Erro ao salvar"})})]}),a.jsxs(O,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:381",className:"border-2 hover:shadow-xl transition-shadow animate-slide-up",style:{animationDelay:"0.1s"},children:[a.jsx(z,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:382",children:a.jsxs(I,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:383",className:"flex items-center gap-3 text-2xl font-black",children:[a.jsx("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:384",className:"p-2 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-xl shadow-lg",children:a.jsx(xa,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:385",className:"h-5 w-5 text-white"})}),"Instruções"]})}),a.jsxs(Y,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:390",className:"grid md:grid-cols-2 gap-4",children:[a.jsxs("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:391",className:"flex items-start gap-3 p-4 rounded-xl bg-gradient-to-r from-indigo-500/5 to-purple-500/5 border-2 border-indigo-500/10",children:[a.jsx("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:392",className:"p-2 bg-indigo-500 rounded-lg",children:a.jsx("span",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:393",className:"text-white font-bold text-sm",children:"1"})}),a.jsxs("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:395",children:[a.jsx("p",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:396",className:"font-bold text-sm",children:"Editar"}),a.jsx("p",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:397",className:"text-sm text-muted-foreground",children:"Clique em uma célula para digitar a atividade"})]})]}),a.jsxs("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:400",className:"flex items-start gap-3 p-4 rounded-xl bg-gradient-to-r from-purple-500/5 to-pink-500/5 border-2 border-purple-500/10",children:[a.jsx("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:401",className:"p-2 bg-purple-500 rounded-lg",children:a.jsx("span",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:402",className:"text-white font-bold text-sm",children:"2"})}),a.jsxs("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:404",children:[a.jsx("p",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:405",className:"font-bold text-sm",children:"Cor"}),a.jsx("p",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:406",className:"text-sm text-muted-foreground",children:"Clique no ícone de paleta para escolher a cor"})]})]}),a.jsxs("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:409",className:"flex items-start gap-3 p-4 rounded-xl bg-gradient-to-r from-pink-500/5 to-rose-500/5 border-2 border-pink-500/10",children:[a.jsx("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:410",className:"p-2 bg-pink-500 rounded-lg",children:a.jsx("span",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:411",className:"text-white font-bold text-sm",children:"3"})}),a.jsxs("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:413",children:[a.jsx("p",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:414",className:"font-bold text-sm",children:"Copiar/Colar"}),a.jsx("p",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:415",className:"text-sm text-muted-foreground",children:"Clique com botão direito para copiar e colar"})]})]}),a.jsxs("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:418",className:"flex items-start gap-3 p-4 rounded-xl bg-gradient-to-r from-rose-500/5 to-orange-500/5 border-2 border-rose-500/10",children:[a.jsx("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:419",className:"p-2 bg-rose-500 rounded-lg",children:a.jsx("span",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:420",className:"text-white font-bold text-sm",children:"4"})}),a.jsxs("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:422",children:[a.jsx("p",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:423",className:"font-bold text-sm",children:"Auto-Save"}),a.jsx("p",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:424",className:"text-sm text-muted-foreground",children:"Suas alterações são salvas automaticamente"})]})]})]})]}),a.jsxs(O,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:431",className:"border-2 hover:shadow-xl transition-shadow animate-slide-up",style:{animationDelay:"0.2s"},children:[a.jsxs(z,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:432",children:[a.jsxs(I,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:433",className:"flex items-center gap-3 text-2xl font-black",children:[a.jsx("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:434",className:"p-2 bg-gradient-to-br from-cyan-500 to-blue-500 rounded-xl shadow-lg",children:a.jsx(Ca,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:435",className:"h-5 w-5 text-white"})}),"Grade Semanal"]}),a.jsx(oa,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:439",className:"text-base",children:"Intervalos de 30 minutos • Clique para editar • Arraste para mover • Clique direito para copiar/colar"})]}),a.jsx(Y,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:443",className:"overflow-x-auto",children:a.jsx("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:444",className:"min-w-[900px]",children:a.jsxs("table",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:445",className:"w-full border-collapse",children:[a.jsx("thead",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:446",children:a.jsxs("tr",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:447",children:[a.jsx("th",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:448",className:"border-2 border-border bg-gradient-to-br from-indigo-500/20 to-cyan-500/20 p-3 text-sm font-black sticky left-0 z-10",children:"Horário"}),K.map((e,o)=>a.jsx("th",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:452",className:"border-2 border-border bg-gradient-to-br from-indigo-500/20 to-cyan-500/20 p-3 text-sm font-black",children:e},o))]})}),a.jsx("tbody",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:458",children:fa.map(e=>ba.map(o=>{const t=`${e}-${o}`;return a.jsxs("tr",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:463",children:[a.jsx("td",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:464",className:"border-2 border-border bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 p-3 text-xs font-mono font-bold sticky left-0 z-10",children:ea(e,o)}),K.map((r,n)=>{const b=f(n,e,o),u=E(n,e,o),i=M===u;return a.jsx(ha,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:473",day:n,hour:e,minute:o,slot:b,isEditing:i,onStartEdit:()=>W(u),onStopEdit:X,onActivityChange:C=>Z(n,e,o,C),onColorPickerOpen:()=>aa(n,e,o),onCopy:()=>G(n,e,o),onPaste:()=>Q(n,e,o),onDragStart:()=>_(n,e,o),onDrop:()=>J(n,e,o),hasCopiedCell:p!==null},u)})]},t)}))})]})})})]}),a.jsx(ra,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:503",open:s!==null,onOpenChange:e=>!e&&T(null),children:a.jsxs(ta,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:504",className:"w-auto max-w-xs border-2",children:[a.jsx(na,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:505",children:a.jsx(la,{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:506",className:"text-lg font-bold",children:"Escolher Cor"})}),a.jsx("div",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:508",className:"grid grid-cols-4 gap-2 py-2",children:va.map(e=>a.jsx("button",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:510",onClick:()=>{s&&(m(s.day,s.hour,s.minute,{color:e.value}),T(null))},className:"w-12 h-12 rounded-lg border-2 border-border hover:scale-110 hover:shadow-lg transition-all",style:{backgroundColor:e.value},title:e.name},e.value))})]})}),a.jsx("style",{"data-loc":"client/src/pages/aluno/AlunoCronograma.tsx:527",children:`
        @keyframes float {
          0%, 100% { transform: translateY(0px); }
          50% { transform: translateY(-20px); }
        }
        
        @keyframes float-delayed {
          0%, 100% { transform: translateY(0px); }
          50% { transform: translateY(-30px); }
        }
        
        @keyframes gradient {
          0%, 100% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
        }
        
        @keyframes pulse-slow {
          0%, 100% { opacity: 0.5; }
          50% { opacity: 0.8; }
        }
        
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        
        @keyframes slide-up {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        
        .animate-float {
          animation: float 8s ease-in-out infinite;
        }
        
        .animate-float-delayed {
          animation: float-delayed 10s ease-in-out infinite;
        }
        
        .animate-gradient {
          background-size: 200% 200%;
          animation: gradient 3s ease infinite;
        }
        
        .animate-pulse-slow {
          animation: pulse-slow 3s ease-in-out infinite;
        }
        
        .animate-fade-in {
          animation: fade-in 0.8s ease-out;
        }
        
        .animate-slide-up {
          animation: slide-up 0.6s ease-out;
        }
      `})]})}export{Ba as default};
