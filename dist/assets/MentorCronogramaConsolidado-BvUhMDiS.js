import{j as a,C as y,f as U,g as W,h as X,b as w,B as A,x as I}from"./index-Cq3VFqDj.js";import{r as l}from"./vendor-recharts-CyIoRYya.js";import{B as Y}from"./badge-eOfJLyX5.js";import{S as F,a as z,b as P,c as T,d as u}from"./select-BfTRQSEa.js";import{m as Z}from"./api-De4okICR.js";import{t as aa}from"./vendor-ui-Cvn9ctBs.js";import{w as oa,x as ea,y as $,z as ta,e as sa,h as na}from"./vendor-firebase-D50p2GR8.js";import{C as ra}from"./chevron-left-DnBMbmZc.js";import{C as E}from"./calendar-l9tlgpg9.js";import{C as da}from"./chevron-right-D8NbrtpH.js";import"./vendor-react-YualkU3Z.js";import"./index-BjdyZ-FF.js";import"./index-ChHGvnL7.js";import"./check-D2prJoNB.js";function ba(){const[M,B]=l.useState([]),[R,V]=l.useState({}),[q,v]=l.useState(!0),[d,b]=l.useState(0),[x,L]=l.useState("agenda"),[p,Q]=l.useState({}),N=["Segunda","Terça","Quarta","Quinta","Sexta","Sábado","Domingo"],S={1:"Segunda",2:"Terça",3:"Quarta",4:"Quinta",5:"Sexta",6:"Sábado",0:"Domingo"};l.useEffect(()=>{k()},[d,x,p]);const k=async()=>{try{v(!0);const o=await Z.getAlunos();B(o);const t={};for(const e of o)try{const s=p[e.id]||x;t[e.id]=await G(e.userId,s)}catch{t[e.id]=[]}V(t)}catch(o){aa.error(o.message||"Erro ao carregar dados")}finally{v(!1)}},G=async(o,t)=>{const e=D(),s=e[0],r=e[6];if(t==="agenda"){const i=oa(I,`alunos/${o}/agenda`),c=ea(i,$("data",">=",s.toISOString().split("T")[0]),$("data","<=",r.toISOString().split("T")[0]));return(await ta(c)).docs.map(C=>{const n=C.data(),m=new Date(n.data);return{...n,id:C.id,dia:S[m.getDay()],atividade:n.titulo==="Outra atividade"&&n.descricao?n.descricao:n.titulo||n.atividade||"Sem título",horaInicio:n.horaInicio||"",horaFim:n.horaFim||""}})}else{const i=sa(I,`alunos/${o}/cronograma/dinamico`),c=await na(i);if(!c.exists())return[];const C=c.data().schedule||[],n=[];return C.forEach(m=>{const j=new Date(m.date);j>=s&&j<=r&&(m.tasks||[]).forEach(g=>{n.push({id:`${m.date}_${g.name}`,dia:S[j.getDay()],atividade:g.name||"Sem título",materia:g.subject||"",duracao:g.duration||0,tipo:g.type||"",horaInicio:"",horaFim:""})})}),n}},D=()=>{const o=new Date,t=o.getDay(),e=t===0?-6:1-t,s=new Date(o);return s.setDate(o.getDate()+e+d*7),s.setHours(0,0,0,0),Array.from({length:7},(r,i)=>{const c=new Date(s);return c.setDate(s.getDate()+i),c})},h=D(),H=(o,t)=>(R[o]||[]).filter(s=>s.dia===t),f=o=>o.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"}),O=()=>d===0?"Semana Atual":d===1?"Próxima Semana":d===-1?"Semana Passada":d>0?`Daqui a ${d} semanas`:`Há ${Math.abs(d)} semanas`,_=(o,t)=>{Q(e=>({...e,[o]:t}))},J=o=>p[o]||x;return q?a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:179",className:"flex items-center justify-center min-h-screen",children:a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:180",className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:186",className:"container mx-auto p-6 space-y-6",children:[a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:187",className:"flex items-center justify-between",children:a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:188",children:[a.jsx("h1",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:189",className:"text-3xl font-bold",children:"Cronograma Consolidado"}),a.jsx("p",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:190",className:"text-muted-foreground",children:"Visualize as atividades de todos os alunos em uma única visão"})]})}),a.jsxs(y,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:197",children:[a.jsxs(U,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:198",children:[a.jsx(W,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:199",children:"Configurações de Visualização"}),a.jsx(X,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:200",children:"Selecione a fonte de dados para visualização"})]}),a.jsxs(w,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:202",className:"space-y-4",children:[a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:204",className:"flex items-center gap-4",children:[a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:205",className:"flex-1",children:[a.jsx("label",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:206",className:"text-sm font-medium",children:"Fonte de Dados Global"}),a.jsx("p",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:207",className:"text-xs text-muted-foreground",children:"Aplica-se a todos os alunos que não têm configuração individual"})]}),a.jsxs(F,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:211",value:x,onValueChange:o=>L(o),children:[a.jsx(z,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:212",className:"w-[200px]",children:a.jsx(P,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:213"})}),a.jsxs(T,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:215",children:[a.jsx(u,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:216",value:"agenda",children:"Agenda"}),a.jsx(u,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:217",value:"dinamico",children:"Cronograma Dinâmico"})]})]})]}),a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:223",className:"flex items-center justify-between pt-4 border-t",children:[a.jsxs(A,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:224",variant:"outline",size:"sm",onClick:()=>b(o=>o-1),children:[a.jsx(ra,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:229",className:"h-4 w-4 mr-1"}),"Semana Anterior"]}),a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:232",className:"flex items-center gap-2",children:[a.jsx(E,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:233",className:"h-5 w-5 text-muted-foreground"}),a.jsx("span",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:234",className:"font-semibold",children:O()}),a.jsxs(Y,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:235",variant:"outline",children:[f(h[0])," - ",f(h[6])]})]}),a.jsxs(A,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:239",variant:"outline",size:"sm",onClick:()=>b(o=>o+1),children:["Próxima Semana",a.jsx(da,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:245",className:"h-4 w-4 ml-1"})]})]})]})]}),a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:252",className:"overflow-x-auto",children:a.jsxs("table",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:253",className:"w-full border-collapse",children:[a.jsx("thead",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:254",children:a.jsxs("tr",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:255",className:"border-b",children:[a.jsx("th",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:256",className:"text-left p-4 bg-muted/50 font-semibold sticky left-0 z-10 bg-background border-r min-w-[200px]",children:"Aluno"}),N.map((o,t)=>a.jsxs("th",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:260",className:"text-center p-4 bg-muted/50 font-semibold min-w-[150px]",children:[a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:261",children:o}),a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:262",className:"text-xs font-normal text-muted-foreground",children:f(h[t])})]},o))]})}),a.jsx("tbody",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:269",children:M.map(o=>{const t=J(o.id);return a.jsxs("tr",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:273",className:"border-b hover:bg-muted/30",children:[a.jsx("td",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:274",className:"p-4 sticky left-0 bg-background border-r",children:a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:275",className:"space-y-2",children:[a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:276",className:"font-medium",children:o.nome}),a.jsxs(F,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:277",value:t,onValueChange:e=>_(o.id,e),children:[a.jsx(z,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:281",className:"w-full h-8 text-xs",children:a.jsx(P,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:282"})}),a.jsxs(T,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:284",children:[a.jsx(u,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:285",value:"agenda",children:"Agenda"}),a.jsx(u,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:286",value:"dinamico",children:"Dinâmico"})]})]})]})}),N.map(e=>{const s=H(o.id,e);return a.jsx("td",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:294",className:"p-2 align-top",children:a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:295",className:"space-y-1",children:s.length===0?a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:297",className:"text-xs text-muted-foreground text-center py-2",children:"-"}):s.map((r,i)=>a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:302",className:"text-xs p-2 rounded bg-blue-50 border border-blue-200",children:[a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:306",className:"font-medium truncate",title:r.atividade,children:r.atividade}),r.horaInicio&&a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:310",className:"text-muted-foreground",children:[r.horaInicio,r.horaFim&&` - ${r.horaFim}`]})]},i))})},e)})]},o.id)})})]})}),M.length===0&&a.jsx(y,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:330",children:a.jsxs(w,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:331",className:"flex flex-col items-center justify-center py-12",children:[a.jsx(E,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:332",className:"h-12 w-12 text-muted-foreground mb-4"}),a.jsx("p",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:333",className:"text-lg font-medium",children:"Nenhum aluno cadastrado"}),a.jsx("p",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:334",className:"text-sm text-muted-foreground",children:"Cadastre alunos para visualizar seus cronogramas"})]})})]})}export{ba as default};
