import{j as a,C as D,f as U,g as W,h as X,b as y,B as w,x as A}from"./index-DbxPnCZQ.js";import{r as c}from"./vendor-recharts-CyIoRYya.js";import{B as Y}from"./badge-D6NoT0BK.js";import{S as I,a as F,b as z,c as P,d as C}from"./select-CKm8zNF6.js";import{m as Z}from"./api-GshIKCi5.js";import{t as aa}from"./vendor-ui-Cvn9ctBs.js";import{w as T,x as oa,y as k,z as B}from"./vendor-firebase-D50p2GR8.js";import{C as ea}from"./chevron-left-DVrEUghJ.js";import{C as E}from"./calendar-Dzjd5PnM.js";import{C as ta}from"./chevron-right-Br9hywrE.js";import"./vendor-react-YualkU3Z.js";import"./index-XogpP7sN.js";import"./index-ChHGvnL7.js";import"./check-R-oVXWLx.js";function fa(){const[j,R]=c.useState([]),[V,$]=c.useState({}),[q,M]=c.useState(!0),[d,v]=c.useState(0),[x,L]=c.useState("agenda"),[u,Q]=c.useState({}),b=["Segunda","Terça","Quarta","Quinta","Sexta","Sábado","Domingo"],N={1:"Segunda",2:"Terça",3:"Quarta",4:"Quinta",5:"Sexta",6:"Sábado",0:"Domingo"};c.useEffect(()=>{G()},[d,x,u]);const G=async()=>{try{M(!0);const o=await Z.getAlunos();R(o);const t={};for(const e of o)try{const s=u[e.id]||x;t[e.id]=await H(e.userId,s)}catch{t[e.id]=[]}$(t)}catch(o){aa.error(o.message||"Erro ao carregar dados")}finally{M(!1)}},H=async(o,t)=>{const e=S(),s=e[0],r=e[6];if(t==="agenda"){const i=T(A,`alunos/${o}/agenda`),l=oa(i,k("data",">=",s.toISOString().split("T")[0]),k("data","<=",r.toISOString().split("T")[0]));return(await B(l)).docs.map(m=>{const n=m.data(),g=new Date(n.data);return{...n,id:m.id,dia:N[g.getDay()],atividade:n.titulo||n.atividade||"Sem título",horaInicio:n.horaInicio||"",horaFim:n.horaFim||""}})}else{const i=T(A,`alunos/${o}/cronograma_anual_dinamico`),l=await B(i),f=[];return l.docs.forEach(m=>{const n=m.data();if(n.data){const g=new Date(n.data);g>=s&&g<=r&&f.push({...n,id:m.id,dia:N[g.getDay()],atividade:n.materia||n.topico||"Sem título",horaInicio:n.horaInicio||"",horaFim:n.horaFim||""})}}),f}},S=()=>{const o=new Date,t=o.getDay(),e=t===0?-6:1-t,s=new Date(o);return s.setDate(o.getDate()+e+d*7),s.setHours(0,0,0,0),Array.from({length:7},(r,i)=>{const l=new Date(s);return l.setDate(s.getDate()+i),l})},p=S(),_=(o,t)=>(V[o]||[]).filter(s=>s.dia===t),h=o=>o.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"}),O=()=>d===0?"Semana Atual":d===1?"Próxima Semana":d===-1?"Semana Passada":d>0?`Daqui a ${d} semanas`:`Há ${Math.abs(d)} semanas`,J=(o,t)=>{Q(e=>({...e,[o]:t}))},K=o=>u[o]||x;return q?a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:168",className:"flex items-center justify-center min-h-screen",children:a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:169",className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:175",className:"container mx-auto p-6 space-y-6",children:[a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:176",className:"flex items-center justify-between",children:a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:177",children:[a.jsx("h1",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:178",className:"text-3xl font-bold",children:"Cronograma Consolidado"}),a.jsx("p",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:179",className:"text-muted-foreground",children:"Visualize as atividades de todos os alunos em uma única visão"})]})}),a.jsxs(D,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:186",children:[a.jsxs(U,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:187",children:[a.jsx(W,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:188",children:"Configurações de Visualização"}),a.jsx(X,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:189",children:"Selecione a fonte de dados para visualização"})]}),a.jsxs(y,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:191",className:"space-y-4",children:[a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:193",className:"flex items-center gap-4",children:[a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:194",className:"flex-1",children:[a.jsx("label",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:195",className:"text-sm font-medium",children:"Fonte de Dados Global"}),a.jsx("p",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:196",className:"text-xs text-muted-foreground",children:"Aplica-se a todos os alunos que não têm configuração individual"})]}),a.jsxs(I,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:200",value:x,onValueChange:o=>L(o),children:[a.jsx(F,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:201",className:"w-[200px]",children:a.jsx(z,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:202"})}),a.jsxs(P,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:204",children:[a.jsx(C,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:205",value:"agenda",children:"Agenda"}),a.jsx(C,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:206",value:"dinamico",children:"Cronograma Dinâmico"})]})]})]}),a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:212",className:"flex items-center justify-between pt-4 border-t",children:[a.jsxs(w,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:213",variant:"outline",size:"sm",onClick:()=>v(o=>o-1),children:[a.jsx(ea,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:218",className:"h-4 w-4 mr-1"}),"Semana Anterior"]}),a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:221",className:"flex items-center gap-2",children:[a.jsx(E,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:222",className:"h-5 w-5 text-muted-foreground"}),a.jsx("span",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:223",className:"font-semibold",children:O()}),a.jsxs(Y,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:224",variant:"outline",children:[h(p[0])," - ",h(p[6])]})]}),a.jsxs(w,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:228",variant:"outline",size:"sm",onClick:()=>v(o=>o+1),children:["Próxima Semana",a.jsx(ta,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:234",className:"h-4 w-4 ml-1"})]})]})]})]}),a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:241",className:"overflow-x-auto",children:a.jsxs("table",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:242",className:"w-full border-collapse",children:[a.jsx("thead",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:243",children:a.jsxs("tr",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:244",className:"border-b",children:[a.jsx("th",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:245",className:"text-left p-4 bg-muted/50 font-semibold sticky left-0 z-10 bg-background border-r min-w-[200px]",children:"Aluno"}),b.map((o,t)=>a.jsxs("th",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:249",className:"text-center p-4 bg-muted/50 font-semibold min-w-[150px]",children:[a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:250",children:o}),a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:251",className:"text-xs font-normal text-muted-foreground",children:h(p[t])})]},o))]})}),a.jsx("tbody",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:258",children:j.map(o=>{const t=K(o.id);return a.jsxs("tr",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:262",className:"border-b hover:bg-muted/30",children:[a.jsx("td",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:263",className:"p-4 sticky left-0 bg-background border-r",children:a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:264",className:"space-y-2",children:[a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:265",className:"font-medium",children:o.nome}),a.jsxs(I,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:266",value:t,onValueChange:e=>J(o.id,e),children:[a.jsx(F,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:270",className:"w-full h-8 text-xs",children:a.jsx(z,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:271"})}),a.jsxs(P,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:273",children:[a.jsx(C,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:274",value:"agenda",children:"Agenda"}),a.jsx(C,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:275",value:"dinamico",children:"Dinâmico"})]})]})]})}),b.map(e=>{const s=_(o.id,e);return a.jsx("td",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:283",className:"p-2 align-top",children:a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:284",className:"space-y-1",children:s.length===0?a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:286",className:"text-xs text-muted-foreground text-center py-2",children:"-"}):s.map((r,i)=>a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:291",className:"text-xs p-2 rounded bg-blue-50 border border-blue-200",children:[a.jsx("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:295",className:"font-medium truncate",title:r.atividade,children:r.atividade}),r.horaInicio&&a.jsxs("div",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:299",className:"text-muted-foreground",children:[r.horaInicio,r.horaFim&&` - ${r.horaFim}`]})]},i))})},e)})]},o.id)})})]})}),j.length===0&&a.jsx(D,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:319",children:a.jsxs(y,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:320",className:"flex flex-col items-center justify-center py-12",children:[a.jsx(E,{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:321",className:"h-12 w-12 text-muted-foreground mb-4"}),a.jsx("p",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:322",className:"text-lg font-medium",children:"Nenhum aluno cadastrado"}),a.jsx("p",{"data-loc":"client/src/pages/mentor/MentorCronogramaConsolidado.tsx:323",className:"text-sm text-muted-foreground",children:"Cadastre alunos para visualizar seus cronogramas"})]})})]})}export{fa as default};
